---
import '../styles/global.css';
import { getLeanPosts } from '../lib/blog';
import MainLayout from '../layouts/MainLayout.astro';

const allPosts = await getLeanPosts();

const initialPosts = allPosts.slice(0, 10);
---
<MainLayout>
  <!-- 主页英雄区 -->
  <section class="max-w-6xl mx-auto px-4 mt-4 mb-16 flex flex-col lg:flex-row gap-4 items-stretch">
    <div class="flex-1 lg:flex-[1.2] group hero-card rounded-4xl p-8 lg:px-12 lg:py-10 border border-slate-100/50 shadow-sm transition-all duration-700 hover:shadow-xl animate-fade-up">
      <div class="relative z-10 flex flex-col h-full justify-between">
        <div class="flex justify-between items-start">
          <div class="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-slate-900/90 shadow-md backdrop-blur-sm">
            <span class="flex h-1.5 w-1.5">
              <span class="animate-ping absolute inline-flex h-1.5 w-1.5 rounded-full bg-blue-400 opacity-75"></span>
              <span class="relative inline-flex rounded-full h-1.5 w-1.5 bg-blue-400"></span>
            </span>
            <span class="text-[8px] font-black text-white uppercase tracking-widest">Active Concept</span>
          </div>
          <span class="text-slate-400 font-mono text-[9px] font-bold tracking-wider">EST. 2024</span>
        </div>

        <div class="space-y-4 my-20">
          <h1 class="text-5xl lg:text-7xl font-black tracking-tighter text-slate-900 leading-none">
            派小站
          </h1>
          <p class="text-slate-500 text-sm font-medium max-w-65 leading-relaxed">
            以<span class="text-slate-900 font-semibold">精密</span>与逻辑，构建理想的数字花园。记录技术与生活的复盘。
          </p>
        </div>

        <div class="flex items-end justify-between border-t border-slate-200/60 pt-5">
          <div class="space-y-0.5">
            <p class="text-[9px] font-black uppercase tracking-widest text-slate-900">V4 Engine</p>
            <p class="text-[8px] font-bold text-slate-400 uppercase tracking-widest">Modular System</p>
          </div>
          <div class="text-[9px] font-mono text-slate-400 font-bold uppercase tracking-wider">Scenery / 01</div>
        </div>
      </div>
    </div>

    <div class="flex-1 lg:flex-[0.8] flex flex-col gap-4">
      <a href="/categories/技术" class="flex-1 p-7 lg:p-8 category-card-tech rounded-4xl flex flex-col justify-between group relative transition-all duration-500 hover:-translate-y-2 shadow-lg shadow-blue-200 animate-fade-up delay-100">
        <div class="flex justify-between items-start z-10">
          <div class="w-12 h-12 rounded-2xl bg-white/20 border border-white/30 backdrop-blur-md flex items-center justify-center transition-transform duration-300 group-hover:scale-110">
            <svg class="w-6 h-6 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M14 10l-2 1m0 0l-2-1m2 1v2.5M20 7l-2 1m2-1l-2-1m2 1v2.5M14 4l-2-1-2 1M4 7l2-1M4 7l2 1M4 7v2.5M12 21l-2-1m2 1l2-1m-2 1v-2.5M6 18l-2-1v-2.5M18 18l2-1v-2.5"/></svg>
          </div>
          <div class="text-white/30 group-hover:text-white transition-all duration-300 transform group-hover:translate-x-1">
            <svg class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M17 8l4 4m0 0l-4 4m4-4H3"/></svg>
          </div>
        </div>
        <div class="z-10">
          <h2 class="text-2xl font-black text-white tracking-tight mb-1">技术笔记</h2>
          <p class="text-white/70 text-[8px] uppercase tracking-[0.25em] font-bold">Logic & Knowledge</p>
        </div>
      </a>

      <a href="/categories/生活" class="flex-1 p-7 lg:p-8 category-card-life bg-white border border-slate-100 rounded-4xl flex flex-col justify-between group hover:shadow-xl transition-all duration-500 hover:-translate-y-2 animate-fade-up delay-200">
        <div class="flex justify-between items-start relative z-10">
          <div class="w-12 h-12 rounded-2xl bg-slate-50 border border-slate-100 flex items-center justify-center text-slate-400 group-hover:text-blue-500 group-hover:bg-blue-50 transition-all duration-500 group-hover:scale-110">
            <svg class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"/></svg>
          </div>
          <div class="text-slate-300 group-hover:text-slate-900 transition-all duration-300 transform group-hover:translate-x-1">
            <svg class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M17 8l4 4m0 0l-4 4m4-4H3"/></svg>
          </div>
        </div>
        <div class="relative z-10">
          <h2 class="text-2xl font-black text-slate-800 tracking-tight mb-1">个人随笔</h2>
          <p class="text-slate-400 text-[8px] uppercase tracking-[0.25em] font-bold">Insight & Moments</p>
        </div>
      </a>
    </div>
  </section>
  
  <!-- 近期归档区 -->
  <div class="max-w-6xl mx-auto px-4 flex items-center gap-4 mb-12">
    <div class="h-px flex-1 bg-linear-to-r from-transparent to-blue-600/20 translate-y-0.5"></div>
    <h2 class="text-[24px] lg:text-[32px] font-black uppercase tracking-[0.4em] text-blue-600/50 leading-none select-none animate-fade-up delay-300">
      Recent Archives
    </h2>
    <div class="h-px flex-1 bg-linear-to-r from-blue-600/20 to-transparent translate-y-0.5"></div>
  </div>


  <section class="max-w-6xl mx-auto px-4">
    <div class="post-grid mb-12">
      {initialPosts.map((post, index) => (
        <article class="post-card group animate-fade-up" style={`animation-delay: ${Math.min(index * 0.1, 0.5)}s; opacity: 0;`}>
          <div class="post-content relative z-10">
            <span class="category-tag">{post.category}</span>

            {post.image && (
              <div class="post-thumbnail mb-6">
                <img src={post.image} alt={post.title} loading="lazy" />
              </div>
            )}

            <a href={`/blog/${post.slug}`} class="block group/title">
              <h3 class="post-title">{post.title}</h3>
            </a>

            <p class="post-description">{post.description}</p>

            {post.tags && post.tags.length > 0 && (
              <div class="flex flex-wrap gap-2 mt-4 mb-6 relative z-20">
                {post.tags.map(tag => (
                  <span class="text-[10px] uppercase tracking-wider px-2.5 py-1.5 bg-slate-100/80 text-slate-500 rounded-lg hover:bg-blue-500 hover:text-white transition-all duration-300 cursor-default hover:shadow-md hover:shadow-blue-500/20">
                    {tag}
                  </span>
                ))}
              </div>
            )}

            <div class="post-footer">
              <div class="flex items-center gap-3">
                <time datetime={post.pubDate.toISOString()}>
                  {post.pubDate.toLocaleDateString('zh-CN', {
                    year: 'numeric',
                    month: 'short',
                    day: 'numeric',
                  })}
                </time>
              </div>
              <span class="read-more-btn">Open Project _</span>
            </div>
          </div>
        </article>
      ))}
    </div>

    <div class="text-center mb-4" id="load-more-wrapper">
      <button
        id="load-more-btn"
        data-next-page="2"
        class="load-more-btn inline-flex items-center gap-4 px-12 py-4 rounded-full border border-slate-200 text-slate-400 text-[10px] font-black uppercase tracking-[0.3em] hover:bg-slate-900 hover:text-white hover:border-slate-900 transition-all duration-500 group"
      >
        <span class="w-1.5 h-1.5 rounded-full bg-blue-500 group-hover:animate-pulse transition-all duration-300"></span>
        加载更多
      </button>
    </div>
  </section>
  
</MainLayout>
